$(document).ready((function(){var e=$("#txtUsuario"),t=$("#txtPrimerNombre"),a=$("#txtPrimerApellido"),r=$("#txtDNI"),s=$("#txtCorreo"),o=$("#slcSexo"),i=$("#txtPassword");let n=$("#tableAdminUser").DataTable({destroy:!0,ajax:{url:"php/users/tablaUsuarios",dataSrc:""},columns:[{data:"idUsuario"},{data:"usuario"},{data:"dni"},{data:"primerNombre"},{data:"segundoNombre"},{data:"primerApellido"},{data:"segundoApellido"},{data:"telefono"},{data:"direccion"},{data:"correo"},{data:"genero"},{defaultContent:'<div class="btn-group" role="group"><button type="button" class="btn btn-warning" id="btnEditar"><i class="fas fa-edit"></i></button><button type="button" class="btn btn-danger" id="btnEliminar" data-bs-toggle="modal" data-bs-target="#modal1"><i class="fa fa-trash"></i></button></div>'}],language:{url:"../resource/spanish.json"}}),l=$("#tablePermissions").DataTable({destroy:!0,ajax:{url:"php/users/tablaPermisos",dataSrc:""},columns:[{data:"usuario"},{data:"permiso_1"},{data:"permiso_2"},{data:"permiso_3"},{data:"permiso_4"},{data:"permiso_5"},{defaultContent:'<div class="btn-group" role="group"><button type="button" class="btn btn-warning" id="btnEditarPermiso"><i class="fas fa-edit"></i></button>'}],language:{url:"../resource/spanish.json"}});function d(){return!!/[\w-\.]{2,}@([\w-]{2,}\.)*([\w-]{2,}\.)[\w-]{2,4}/.test($("#txtCorreo").val().trim())}function u(e){return $(e).val().length>=3}function c(e){alertify.set("notifier","position","top-center"),alertify.error(e)}$("#tablePermissions tbody").on("click","button#btnEditarPermiso",(function(){!function(e){$("#formPermisos #txtId").val(e.idUsuario),$("#formPermisos #txtUsuario").val(e.usuario),$("#formPermisos #permiso1").prop("checked",parseInt(e.p_inventario)),$("#formPermisos #permiso2").prop("checked",parseInt(e.p_facturacion)),$("#formPermisos #permiso3").prop("checked",parseInt(e.p_compras)),$("#formPermisos #permiso4").prop("checked",parseInt(e.p_usuarios)),$("#formPermisos #permiso5").prop("checked",parseInt(e.p_reportes))}(l.row($(this).parents("tr")).data())})),$("#tableAdminUser tbody").on("click","button#btnEditar",(function(){!function(e){$("#formAdminUser #txtId").val(e.idUsuario),$("#txtDNI").val(e.dni),$("#txtPrimerNombre").val(e.primerNombre),$("#txtSegundoNombre").val(e.segundoNombre),$("#txtPrimerApellido").val(e.primerApellido),$("#txtSegundoApellido").val(e.segundoApellido),$("#txtTelefono").val(e.telefono),$("#txtDireccion").val(e.direccion),$("#txtCorreo").val(e.correo),$("#txtUsuario").val(e.usuario),$("#imgPerfil").attr("src","../"+e.rutaImg+"/"+e.nombreImg),"Masculino"==e.genero?$("#slcSexo").val("1"):$("#slcSexo").val("2");$("#btnActualizar").removeClass("d-none")}(n.row($(this).parents("tr")).data())})),$("#tableAdminUser tbody").on("click","button#btnEliminar",(function(){var e=n.row($(this).parents("tr")).data();$("#formEliminarUsuario #txtId").val(e.idUsuario)})),$("#txtTelefono").inputmask({mask:[{mask:"####-####"}],greedy:!1,definitions:{"#":{validator:"[0-9]",cardinality:1}}}),$("#txtDNI").inputmask({mask:[{mask:"####-####-#####"}],greedy:!1,definitions:{"#":{validator:"[0-9]",cardinality:1}}}),$("#formAdminUser").submit((function(i){if(u(r))if(u(t))if(u(a))if(u(e))if(u(s)||d()){if(""!=$(o).val())return!0;c("Debe seleccionar su genero")}else c("Debe ingresar su correo o el correo no es valido");else c("Debe ingresar su nombre de usuario");else c("Debe ingresar su primer apellido");else c("Debe ingresar su primer nombre");else c("Debe ingresar su numero de identidad");i.preventDefault()})),$("#formAddUser").submit((function(n){if(u(r))if(u(t))if(u(a))if(u(e))if(u(i))if(u(s)||d())if(""!=$(o).val()){if(0!==$("#btnImagen")[0].files.length)return!0;c("Debe ingresar una foto de perfil")}else c("Debe seleccionar su genero");else c("Debe ingresar su correo o el correo no es valido");else c("Debe ingresar su contraseña");else c("Debe ingresar su nombre de usuario");else c("Debe ingresar su primer apellido");else c("Debe ingresar su primer nombre");else c("Debe ingresar su numero de identidad");n.preventDefault()})),$.ajax({type:"GET",url:"php/users/tablaEstadoUsuario",data:"data",dataType:"json",success:function(e){for(let s=0;s<e.length;s++){var t,a;"1"==e[s].status?(a='<span class="badge bg-success">'+e[s].Estado+"</span>",t='<a class="btn btn-primary btn-sm" href="php/users/activarDesactivarUsuario?value=0&u='+e[s].id+'" role="button" data-bs-toggle="tooltip" data-bs-placement="right" title="Desactivar"><i class="fas fa-eye-slash"></i></a>'):(a='<span class="badge bg-danger">'+e[s].Estado+"</span>",t='<a class="btn btn-primary btn-sm" href="php/users/activarDesactivarUsuario?value=1&u='+e[s].id+'" role="button" data-bs-toggle="tooltip" data-bs-placement="right" title="Activar"><i class="fas fa-eye"></i></a>');var r="<tr><td>"+e[s].id+"</td><td>"+e[s].usuario+'</td><td class="text-center"><div class="d-grid">'+a+'</div></td><td class="text-center">'+t+"</td></tr>";$("#contentTableStatus").append(r)}}}),$("#btnImagen").change((function(){var e=new FileReader;e.onload=function(e){$("#imgPerfil").attr("src",e.target.result)},e.readAsDataURL(this.files[0])})),$("[title~='noNumber']").keypress((function(e){var t=e.keyCode||e.which,a=String.fromCharCode(t).toLocaleLowerCase();if(-1=="áéíóúabcdefghijklmnopqrstuvwxyz".indexOf(a))return!1}));[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]')).map((function(e){return new bootstrap.Tooltip(e)}))}));